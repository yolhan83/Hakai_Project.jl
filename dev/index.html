<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Hakai_Project.jl</title><meta name="title" content="Home · Hakai_Project.jl"/><meta property="og:title" content="Home · Hakai_Project.jl"/><meta property="twitter:title" content="Home · Hakai_Project.jl"/><meta name="description" content="Documentation for Hakai_Project.jl."/><meta property="og:description" content="Documentation for Hakai_Project.jl."/><meta property="twitter:description" content="Documentation for Hakai_Project.jl."/><meta property="og:url" content="https://github.com/yolhan83/Hakai_Project.jl/"/><meta property="twitter:url" content="https://github.com/yolhan83/Hakai_Project.jl/"/><link rel="canonical" href="https://github.com/yolhan83/Hakai_Project.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Hakai_Project.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/yolhan83/Hakai_Project.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/yolhan83/Hakai_Project.jl/blob/master/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Hakai_Project"><a class="docs-heading-anchor" href="#Hakai_Project">Hakai_Project</a><a id="Hakai_Project-1"></a><a class="docs-heading-anchor-permalink" href="#Hakai_Project" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/yolhan83/Hakai_Project.jl">Hakai_Project</a>.</p><ul><li><a href="#Hakai_Project.Hakai_Project"><code>Hakai_Project.Hakai_Project</code></a></li><li><a href="#Hakai_Project.applyBoundaryConditions!-NTuple{4, Any}"><code>Hakai_Project.applyBoundaryConditions!</code></a></li><li><a href="#Hakai_Project.assignElementMaterial!-Tuple{Vector{Hakai_Project.PartType}, Vector{Hakai_Project.InstanceType}, Vector{Hakai_Project.MaterialType}}"><code>Hakai_Project.assignElementMaterial!</code></a></li><li><a href="#Hakai_Project.buildGlobalModel!-Tuple{Vector{Hakai_Project.PartType}, Vector{Hakai_Project.InstanceType}}"><code>Hakai_Project.buildGlobalModel!</code></a></li><li><a href="#Hakai_Project.buildMassDamping-Tuple{Any, Any}"><code>Hakai_Project.buildMassDamping</code></a></li><li><a href="#Hakai_Project.cal_BVbar_hexa-Tuple{Any, Any, Any}"><code>Hakai_Project.cal_BVbar_hexa</code></a></li><li><a href="#Hakai_Project.cal_Bfinal-NTuple{4, Any}"><code>Hakai_Project.cal_Bfinal</code></a></li><li><a href="#Hakai_Project.cal_Pusai_hexa-Tuple{Any}"><code>Hakai_Project.cal_Pusai_hexa</code></a></li><li><a href="#Hakai_Project.cal_contact_force-Tuple{Any, Any, Any, Any, Matrix{Float64}, Vector{Float64}, Vector{Float64}, Float64, Float64, Float64, Vector{Int64}, Matrix{Int64}, Any, Any}"><code>Hakai_Project.cal_contact_force</code></a></li><li><a href="#Hakai_Project.cal_node_stress_strain-Tuple{Int64, Matrix{Int64}, Int64, Hakai_Project.IntegDataType}"><code>Hakai_Project.cal_node_stress_strain</code></a></li><li><a href="#Hakai_Project.cal_stress_hexa-Tuple{Any, Any, Any, Any, Any, Any, Any, Matrix{Int64}, Vector{Int64}, Int64, Any, Vector{Hakai_Project.MaterialType}, Vector{Int64}, Float64, Vector{Float64}}"><code>Hakai_Project.cal_stress_hexa</code></a></li><li><a href="#Hakai_Project.computeElementVolumes-Tuple{Any, Any}"><code>Hakai_Project.computeElementVolumes</code></a></li><li><a href="#Hakai_Project.doFractureCheck!-NTuple{6, Any}"><code>Hakai_Project.doFractureCheck!</code></a></li><li><a href="#Hakai_Project.drawGraph-Tuple{Any}"><code>Hakai_Project.drawGraph</code></a></li><li><a href="#Hakai_Project.findLineIndices-Tuple{Vector{String}, String}"><code>Hakai_Project.findLineIndices</code></a></li><li><a href="#Hakai_Project.get_element_face-Tuple{Any, Any}"><code>Hakai_Project.get_element_face</code></a></li><li><a href="#Hakai_Project.get_surface_triangle-Tuple{Any, Any, Any}"><code>Hakai_Project.get_surface_triangle</code></a></li><li><a href="#Hakai_Project.initDisplacementVelocity-NTuple{5, Any}"><code>Hakai_Project.initDisplacementVelocity</code></a></li><li><a href="#Hakai_Project.main-Tuple{Any}"><code>Hakai_Project.main</code></a></li><li><a href="#Hakai_Project.my3SolveAb-NTuple{12, Float64}"><code>Hakai_Project.my3SolveAb</code></a></li><li><a href="#Hakai_Project.my3crossNNz-NTuple{6, Float64}"><code>Hakai_Project.my3crossNNz</code></a></li><li><a href="#Hakai_Project.parseAmplitudes-Tuple{Vector{String}}"><code>Hakai_Project.parseAmplitudes</code></a></li><li><a href="#Hakai_Project.parseBC-Tuple{Vector{String}, Vector{Hakai_Project.AmplitudeType}, Vector{Hakai_Project.InstanceType}, Vector{Hakai_Project.PartType}, Vector{Hakai_Project.NsetType}}"><code>Hakai_Project.parseBC</code></a></li><li><a href="#Hakai_Project.parseContactFlag-Tuple{Vector{String}}"><code>Hakai_Project.parseContactFlag</code></a></li><li><a href="#Hakai_Project.parseContactPairs-Tuple{Vector{String}, Vector{Hakai_Project.SurfaceType}}"><code>Hakai_Project.parseContactPairs</code></a></li><li><a href="#Hakai_Project.parseGlobalElsets-Tuple{Vector{String}, Vector{Hakai_Project.InstanceType}}"><code>Hakai_Project.parseGlobalElsets</code></a></li><li><a href="#Hakai_Project.parseGlobalNsets-Tuple{Vector{String}, Vector{Hakai_Project.InstanceType}}"><code>Hakai_Project.parseGlobalNsets</code></a></li><li><a href="#Hakai_Project.parseIC-Tuple{Vector{String}, Vector{Hakai_Project.InstanceType}, Vector{Hakai_Project.PartType}, Vector{Hakai_Project.NsetType}}"><code>Hakai_Project.parseIC</code></a></li><li><a href="#Hakai_Project.parseInstances-Tuple{Vector{String}, Vector{Hakai_Project.PartType}}"><code>Hakai_Project.parseInstances</code></a></li><li><a href="#Hakai_Project.parseMassScaling-Tuple{Vector{String}}"><code>Hakai_Project.parseMassScaling</code></a></li><li><a href="#Hakai_Project.parseMaterials-Tuple{Vector{String}}"><code>Hakai_Project.parseMaterials</code></a></li><li><a href="#Hakai_Project.parseParts-Tuple{Vector{String}}"><code>Hakai_Project.parseParts</code></a></li><li><a href="#Hakai_Project.parseStep-Tuple{Vector{String}}"><code>Hakai_Project.parseStep</code></a></li><li><a href="#Hakai_Project.parseSurfaces-Tuple{Vector{String}, Vector{Hakai_Project.ELsetType}}"><code>Hakai_Project.parseSurfaces</code></a></li><li><a href="#Hakai_Project.prepareMaterialProperties!-Tuple{Any}"><code>Hakai_Project.prepareMaterialProperties!</code></a></li><li><a href="#Hakai_Project.readFile-Tuple{String}"><code>Hakai_Project.readFile</code></a></li><li><a href="#Hakai_Project.readInpFile-Tuple{String}"><code>Hakai_Project.readInpFile</code></a></li><li><a href="#Hakai_Project.runMainTimeLoop!-NTuple{11, Any}"><code>Hakai_Project.runMainTimeLoop!</code></a></li><li><a href="#Hakai_Project.setupContact!-Tuple{Any}"><code>Hakai_Project.setupContact!</code></a></li><li><a href="#Hakai_Project.write_vtk-Tuple{Int64, AbstractMatrix{Float64}, AbstractMatrix{Int64}, AbstractVector{Int64}, AbstractVector{Float64}, AbstractVector{Float64}, Hakai_Project.NodeDataType}"><code>Hakai_Project.write_vtk</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.Hakai_Project" href="#Hakai_Project.Hakai_Project"><code>Hakai_Project.Hakai_Project</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Package Hakai_Project v0.0.1</code></pre><p>This package refactor code from https://github.com/yozoyugen/HAKAI-fem for user to use it.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai_Project.jl#L5-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.applyBoundaryConditions!-NTuple{4, Any}" href="#Hakai_Project.applyBoundaryConditions!-NTuple{4, Any}"><code>Hakai_Project.applyBoundaryConditions!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">applyBoundaryConditions!(MODEL, disp_new, step, d_time)</code></pre><p>Implements the boundary conditions each time step, using amplitude interpolation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L670-L674">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.assignElementMaterial!-Tuple{Vector{Hakai_Project.PartType}, Vector{Hakai_Project.InstanceType}, Vector{Hakai_Project.MaterialType}}" href="#Hakai_Project.assignElementMaterial!-Tuple{Vector{Hakai_Project.PartType}, Vector{Hakai_Project.InstanceType}, Vector{Hakai_Project.MaterialType}}"><code>Hakai_Project.assignElementMaterial!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assignElementMaterial!(PART, INSTANCE, MATERIAL) -&gt; (element_material, element_instance)</code></pre><p>Given PART, INSTANCE, and MATERIAL arrays, figure out the material assignments per element and also record which instance each element belongs to.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L783-L788">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.buildGlobalModel!-Tuple{Vector{Hakai_Project.PartType}, Vector{Hakai_Project.InstanceType}}" href="#Hakai_Project.buildGlobalModel!-Tuple{Vector{Hakai_Project.PartType}, Vector{Hakai_Project.InstanceType}}"><code>Hakai_Project.buildGlobalModel!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">buildGlobalModel!(PART, INSTANCE) -&gt; (nNode, coordmat, nElement, elementmat)</code></pre><p>Given the PART and INSTANCE arrays, iterates over each instance to:</p><ul><li>apply translations/rotations</li><li>assemble global coord and element arrays</li></ul><p>Returns the global node count, global coordinate matrix, global element count, and global element matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L562-L569">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.buildMassDamping-Tuple{Any, Any}" href="#Hakai_Project.buildMassDamping-Tuple{Any, Any}"><code>Hakai_Project.buildMassDamping</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">buildMassDamping(MODEL, elementVolume; mass_scaling=1.0)</code></pre><p>Constructs the diagonal mass and damping arrays diag<em>M, diag</em>C based on element densities and volumes. Applies mass scaling.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L128-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.cal_BVbar_hexa-Tuple{Any, Any, Any}" href="#Hakai_Project.cal_BVbar_hexa-Tuple{Any, Any, Any}"><code>Hakai_Project.cal_BVbar_hexa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cal_BVbar_hexa(Pusai_mat, e_position, BVbar)</code></pre><p>Given:</p><ul><li><code>Pusai_mat</code>: a Vector of 8 SMatrix{3,8,Float64} (or MMatrix{3,8}), each storing the local shape  function derivatives at one Gauss point of a hexahedron.</li><li><code>e_position</code>: a 3×8 matrix of the current coordinates of this element’s nodes.</li><li><code>BVbar</code>: a 6×24 MMatrix (or Array) to which we add the volumetric parts for the B-bar approach.</li></ul><p>This function:</p><ol><li>Loops over each of the 8 Gauss points.</li><li>Computes the determinant of the Jacobian (<code>detJi</code>) from <code>Pusai_mat[k] * e_position</code>.</li><li>Accumulates the (1/3)<em>N</em>(detJi) terms into <code>BVbar[1:3, :]</code>.</li><li>Returns the total element volume by summing the 8 <code>detJi</code> values.</li></ol><p>The final <code>BVbar</code> is then used in a “Bbar” method (like Simo/Hughes anti-volumetric locking approach).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L2049-L2065">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.cal_Bfinal-NTuple{4, Any}" href="#Hakai_Project.cal_Bfinal-NTuple{4, Any}"><code>Hakai_Project.cal_Bfinal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cal_Bfinal(Bfinal, BVbar, Pusai1, e_position)</code></pre><p>Computes the final strain-displacement matrix <code>Bfinal</code> for a single Gauss point of an 8-node hexahedron using a &quot;B-bar&quot; type approach. Specifically:</p><ol><li>Compute the local 3×3 Jacobian from <code>Pusai1</code> and <code>e_position</code>.</li><li>Invert it and build the base B-matrix for the standard part.</li><li>Subtract or add the volumetric correction from <code>BVbar</code>.</li><li>Return the determinant of the Jacobian (for weighting).</li></ol><p><strong>Arguments</strong>:   • <code>Bfinal</code>  : a 6×24 matrix (initially zero) where we&#39;ll store the final B at this Gauss point.   • <code>BVbar</code>   : a 6×24 matrix containing the volumetric part from <code>cal_BVbar_hexa</code>.   • <code>Pusai1</code>  : a 3×8 matrix of shape-function derivatives at this Gauss point (from <code>Pusai_mat</code>).   • <code>e_position</code>: a 3×8 matrix of the current coordinates of this element’s 8 nodes.</p><p><strong>Returns</strong>:   • <code>detJi</code>   : The determinant of the 3×3 Jacobian, used as the integration weight factor.</p><p><strong>Notes</strong>:   • If you strictly follow your original code logic, you might do:         Bfinal = B - BV + BVbar     or something similar. Here we embed that logic.     • The typical 6×24 B is formed from partial derivatives (dN/dx, etc.) mapped by the Jacobian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L2148-L2172">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.cal_Pusai_hexa-Tuple{Any}" href="#Hakai_Project.cal_Pusai_hexa-Tuple{Any}"><code>Hakai_Project.cal_Pusai_hexa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cal_Pusai_hexa(integ_num)</code></pre><p>Generates the shape-function gradient matrices for an 8-integration-point hexahedral element. Returns an array of size <code>integ_num</code> where each entry is a 3×8 matrix (Pusai1), storing the derivatives of shape functions in local coordinates (gzai, eta, tueta).</p><p><code>integ_num</code> is typically 8 for a standard hexahedron with 2×2×2 integration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L806-L815">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.cal_contact_force-Tuple{Any, Any, Any, Any, Matrix{Float64}, Vector{Float64}, Vector{Float64}, Float64, Float64, Float64, Vector{Int64}, Matrix{Int64}, Any, Any}" href="#Hakai_Project.cal_contact_force-Tuple{Any, Any, Any, Any, Matrix{Float64}, Vector{Float64}, Vector{Float64}, Float64, Float64, Float64, Vector{Int64}, Matrix{Int64}, Any, Any}"><code>Hakai_Project.cal_contact_force</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cal_contact_force(c_force3, CT, instance_pair, cp_index,
                  position::Array{Float64,2}, velo::Array{Float64,1}, diag_M::Array{Float64,1},
                  elementMinSize::Float64, elementMaxSize::Float64, d_max::Float64,
                  element_flag::Array{Int,1}, elementmat::Array{Int,2}, bug_report, time_)</code></pre><p>Computes contact forces between a set of points (c<em>nodes</em>i) and triangular faces (c_triangles) from the <code>ContactTriangle</code> array <code>CT</code>. The core logic:</p><ol><li>For each contact pair, gather the relevant nodes/triangles.</li><li>Build a small coarse grid (node<em>map</em>ix, node<em>map</em>iy, node<em>map</em>iz, etc.) to skip far-apart node/triangle checks.</li><li>For any node that lies within the normal-projection distance <code>d_lim</code> from a triangle, compute normal penalty force and friction. Accumulate into <code>c_force3</code>.</li><li>We do both damping and friction calculations, so the contact model is basically a penalty approach.</li></ol><p>The array <code>c_force3</code> is 2D: size (fn × Threads.nthreads()) so each thread can accumulate forces without race conditions. The final combination is done after the function, by summation across the second dimension if needed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L1445-L1463">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.cal_node_stress_strain-Tuple{Int64, Matrix{Int64}, Int64, Hakai_Project.IntegDataType}" href="#Hakai_Project.cal_node_stress_strain-Tuple{Int64, Matrix{Int64}, Int64, Hakai_Project.IntegDataType}"><code>Hakai_Project.cal_node_stress_strain</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cal_node_stress_strain(nNode::Int, elementmat::Array{Int,2}, integ_num::Int, integ_data::IntegDataType)</code></pre><p>Averages integration-point (Gauss-point) stress/strain values to each node. Returns a <code>NodeDataType</code> containing:</p><p>• <code>node_stress</code>          (nNode×6)  – the averaged stress at each node   • <code>node_strain</code>          (nNode×6)  – the averaged strain at each node   • <code>node_plastic_strain</code>  (nNode×6)  – (currently unused, but included for completeness)   • <code>node_eq_plastic_strain</code> (nNode) – the averaged equivalent plastic strain at each node   • <code>node_mises_stress</code>    (nNode)   – Mises stress computed from <code>node_stress</code>   • <code>node_triax_stress</code>    (nNode)   – triaxial (mean stress / Mises) ratio</p><p>Notes:</p><ul><li><code>integ_data.integ_stress</code> and <code>integ_data.integ_strain</code> are stored in column-major with shape (6 × nElement*integ_num). This function first aggregates them per element, then sums over nodes.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L1087-L1104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.cal_stress_hexa-Tuple{Any, Any, Any, Any, Any, Any, Any, Matrix{Int64}, Vector{Int64}, Int64, Any, Vector{Hakai_Project.MaterialType}, Vector{Int64}, Float64, Vector{Float64}}" href="#Hakai_Project.cal_stress_hexa-Tuple{Any, Any, Any, Any, Any, Any, Any, Matrix{Int64}, Vector{Int64}, Int64, Any, Vector{Hakai_Project.MaterialType}, Vector{Int64}, Float64, Vector{Float64}}"><code>Hakai_Project.cal_stress_hexa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cal_stress_hexa(Qe, integ_stress::Array{Float64,2}, integ_strain::Array{Float64,2},
                integ_yield_stress::Array{Float64,1}, integ_eq_plastic_strain::Array{Float64,1},
                position_::Array{Float64,2}, d_disp_::Array{Float64,1},
                elementmat::Array{Int,2}, element_flag::Array{Int,1}, integ_num::Int,
                Pusai_mat::Vector{SMatrix{3,8,Float64}},  # or your MMatrix type
                MATERIAL::Array{MaterialType,1},
                element_material::Array{Int,1},
                elementMinSize::Float64,
                elementVolume::Array{Float64,1})</code></pre><p>Computes the internal forces for each element (<code>Qe</code>) as well as updating integration-point stress/strain with an 8-integration-point hexahedral formulation. The parameters are:</p><p>• <code>Qe</code>        : a 24×nElement array of element-level force vectors (24 = 3 dofs × 8 nodes).   • <code>integ_stress</code> : a 6×(nElement<em>integ<em>num) array of stress at each Gauss point, updated in-place.   • `integ</em>strain` : a 6×(nElement</em>integ<em>num) array of strain at each Gauss point, updated in-place.   • `integ</em>yield<em>stress<code>,</code>integ</em>eq<em>plastic</em>strain<code>: 1D arrays for yield stress and eq. plastic strain, each has nElement*integ_num length.   •</code>position<em><code>: a 3×nNode array of current node coordinates.   •</code>d</em>disp<em>`   : a (3×nNode) vector storing this step&#39;s incremental displacement (disp</em>new - disp<em>old).   • <code>elementmat</code>: an 8×nElement array listing node indices of each element.   • `element</em>flag<code>: integer array (1 or 0) indicating which elements are active vs. deleted.   •</code>integ<em>num<code>: number of integration points per element (8).   •</code>Pusai</em>mat<code>: the shape-function derivative data for each integration point.   •</code>MATERIAL<code>: array of your custom</code>MaterialType<code>, from which we get Dmat, G, plastic table, etc.   •</code>element_material<code>: an array giving the material ID for each element.   •</code>elementMinSize<code>: minimum element size (used in some checks, can be ignored if not used).   •</code>elementVolume`    : array of size nElement for (maybe) updated volume if the code modifies it.</p><p><strong>What it does</strong>:</p><ul><li>Loops over each element (if <code>element_flag[e] == 1</code>).</li><li>Gathers that element’s incremental displacement, forms the B-matrix, and obtains the stress increment.</li><li>If the material is plastic, applies a radial return or linear hardening logic (the code does a simple “incremental” approach).</li><li>Updates <code>integ_stress</code> and <code>integ_strain</code> at each Gauss point.</li><li>Accumulates the element internal force vector into the <code>Qe</code> array.</li></ul><p><strong>Returns</strong> nothing, but modifies <code>Qe</code>, <code>integ_stress</code>, <code>integ_strain</code>, etc. in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L1830-L1867">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.computeElementVolumes-Tuple{Any, Any}" href="#Hakai_Project.computeElementVolumes-Tuple{Any, Any}"><code>Hakai_Project.computeElementVolumes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">computeElementVolumes(MODEL, Pusai_mat; integ_num=8)</code></pre><p>Given the shape function matrix (Pusai_mat) and the MODEL&#39;s global coords, compute the volume for each element (summing over integration points). Returns an array of volumes, one per element.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L101-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.doFractureCheck!-NTuple{6, Any}" href="#Hakai_Project.doFractureCheck!-NTuple{6, Any}"><code>Hakai_Project.doFractureCheck!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">doFractureCheck!(MODEL, element_flag, eq_plastic, triax, integ_stress, integ_strain)</code></pre><p>Checks which elements should be &quot;deleted&quot; (element<em>flag=0) based on the ductile data in MATERIAL. Sets integr</em>stress/strain to zero in any deleted element&#39;s integration points. The logic matches your original code.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L581-L587">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.drawGraph-Tuple{Any}" href="#Hakai_Project.drawGraph-Tuple{Any}"><code>Hakai_Project.drawGraph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">drawGraph(output)</code></pre><p>Plot the output (e.g. a time history) using Plots.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai_Project.jl#L29-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.findLineIndices-Tuple{Vector{String}, String}" href="#Hakai_Project.findLineIndices-Tuple{Vector{String}, String}"><code>Hakai_Project.findLineIndices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">findLineIndices(lines::Vector{String}, pattern::String) -&gt; Vector{Int}</code></pre><p>Returns all line indices in <code>lines</code> that contain the given <code>pattern</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L170-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.get_element_face-Tuple{Any, Any}" href="#Hakai_Project.get_element_face-Tuple{Any, Any}"><code>Hakai_Project.get_element_face</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_element_face(MODEL, i)</code></pre><p>For the i-th instance in <code>MODEL</code>, returns three arrays describing the faces of each hexahedral element:</p><ul><li><code>faces</code>       : A (nE*6)×4 matrix of node indices, where nE is the number of elements.                 Each group of 6 rows corresponds to the 6 faces of one element.</li><li><code>faces_eleid</code> : A vector of length (nE*6) indicating which element each face row belongs to.</li><li><code>sorted_faces</code>: Same as <code>faces</code> but with each row sorted so that face matching can be performed                 (useful for detecting shared faces, external faces, etc.).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L872-L883">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.get_surface_triangle-Tuple{Any, Any, Any}" href="#Hakai_Project.get_surface_triangle-Tuple{Any, Any, Any}"><code>Hakai_Project.get_surface_triangle</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_surface_triangle(INSTANCE_i, array_element, contact_element)</code></pre><p>Given a single <code>InstanceType</code> (<code>INSTANCE_i</code>), an array of local element indices (<code>array_element</code>), and a subset of those elements (<code>contact_element</code>), returns:</p><ol><li><code>c_triangles</code>       : An array of triangle faces (two triangles per quadrilateral face).</li><li><code>c_triangles_eleid</code> : A matching array of element indices for each triangle row in <code>c_triangles</code>.</li><li><code>c_nodes</code>           : A sorted and unique list of all node indices used in <code>c_triangles</code>.</li></ol><p>This is typically used in contact calculations to extract the exposed surface triangles for a subset of elements, so that point-vs-triangle collision or gap can be computed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L947-L960">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.initDisplacementVelocity-NTuple{5, Any}" href="#Hakai_Project.initDisplacementVelocity-NTuple{5, Any}"><code>Hakai_Project.initDisplacementVelocity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initDisplacementVelocity(MODEL, nNode, d_time, diag_M, mass_scaling)</code></pre><p>Creates and returns arrays for disp, disp<em>new, disp</em>pre, velo, and position. Also applies initial conditions from MODEL.IC if present.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L168-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.main-Tuple{Any}" href="#Hakai_Project.main-Tuple{Any}"><code>Hakai_Project.main</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">main()</code></pre><p>Read the input file (from ARGS), run the simulation and produce output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai_Project.jl#L40-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.my3SolveAb-NTuple{12, Float64}" href="#Hakai_Project.my3SolveAb-NTuple{12, Float64}"><code>Hakai_Project.my3SolveAb</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">my3SolveAb(A11::Float64, A21::Float64, A31::Float64,
           A12::Float64, A22::Float64, A32::Float64,
           A13::Float64, A23::Float64, A33::Float64,
           bx::Float64, by::Float64, bz::Float64)</code></pre><p>Solves the 3×3 linear system <code>A * x = b</code>, where <code>A</code> is:     [ A11  A12  A13 ]     [ A21  A22  A23 ]     [ A31  A32  A33 ] and <code>b = (bx, by, bz)</code>, returning <code>(x1, x2, x3)</code>.</p><p>It effectively does a manual determinant-based inverse of A:</p><p>```math (A^-1) = 1/det(A) * adj(A) then multiplies by b. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L1783-L1799">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.my3crossNNz-NTuple{6, Float64}" href="#Hakai_Project.my3crossNNz-NTuple{6, Float64}"><code>Hakai_Project.my3crossNNz</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">my3crossNNz(a1::Float64, a2::Float64, a3::Float64, b1::Float64, b2::Float64, b3::Float64)</code></pre><p>Returns <code>(nx, ny, nz)</code> which is the normalized cross product of vectors <code>a = (a1, a2, a3)</code> and <code>b = (b1, b2, b3)</code>. In other words, it does:</p><p>```math n = (a × b) / ‖a × b‖ where ‖⋅‖ denotes the Euclidean norm. The result (nx, ny, nz) is the unit normal.</p><p>Example usage: nx, ny, nz = my3crossNNz(1.0, 0.0, 0.0, 0.0, 1.0, 0.0)  # =&gt; (0, 0, 1)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L1757-L1769">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.parseAmplitudes-Tuple{Vector{String}}" href="#Hakai_Project.parseAmplitudes-Tuple{Vector{String}}"><code>Hakai_Project.parseAmplitudes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parseAmplitudes(lines) -&gt; Vector{AmplitudeType}</code></pre><p>Parses *Amplitude blocks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L640-L644">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.parseBC-Tuple{Vector{String}, Vector{Hakai_Project.AmplitudeType}, Vector{Hakai_Project.InstanceType}, Vector{Hakai_Project.PartType}, Vector{Hakai_Project.NsetType}}" href="#Hakai_Project.parseBC-Tuple{Vector{String}, Vector{Hakai_Project.AmplitudeType}, Vector{Hakai_Project.InstanceType}, Vector{Hakai_Project.PartType}, Vector{Hakai_Project.NsetType}}"><code>Hakai_Project.parseBC</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parseBC(lines, AMPLITUDE, INSTANCE, PART, NSET) -&gt; Vector{BCType}</code></pre><p>Parses *Boundary blocks, linking to amplitude if specified.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L852-L856">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.parseContactFlag-Tuple{Vector{String}}" href="#Hakai_Project.parseContactFlag-Tuple{Vector{String}}"><code>Hakai_Project.parseContactFlag</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parseContactFlag(lines) -&gt; Int</code></pre><p>Checks if *Contact or *Contact Inclusions (with self-contact) is present. Returns:   0 = no contact   1 = general contact   2 = self-contact</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L1052-L1060">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.parseContactPairs-Tuple{Vector{String}, Vector{Hakai_Project.SurfaceType}}" href="#Hakai_Project.parseContactPairs-Tuple{Vector{String}, Vector{Hakai_Project.SurfaceType}}"><code>Hakai_Project.parseContactPairs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parseContactPairs(lines, SURFACE) -&gt; Vector{CPType}</code></pre><p>Parses *Contact Pair blocks into CPType.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L1081-L1085">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.parseGlobalElsets-Tuple{Vector{String}, Vector{Hakai_Project.InstanceType}}" href="#Hakai_Project.parseGlobalElsets-Tuple{Vector{String}, Vector{Hakai_Project.InstanceType}}"><code>Hakai_Project.parseGlobalElsets</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parseGlobalElsets(lines, INSTANCE) -&gt; Vector{ELsetType}</code></pre><p>Parses any *Elset with &quot;instance=&quot; at the global level.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L437-L441">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.parseGlobalNsets-Tuple{Vector{String}, Vector{Hakai_Project.InstanceType}}" href="#Hakai_Project.parseGlobalNsets-Tuple{Vector{String}, Vector{Hakai_Project.InstanceType}}"><code>Hakai_Project.parseGlobalNsets</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parseGlobalNsets(lines, INSTANCE) -&gt; Vector{NsetType}</code></pre><p>Parses any *Nset with &quot;instance=&quot; at the global level.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L368-L372">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.parseIC-Tuple{Vector{String}, Vector{Hakai_Project.InstanceType}, Vector{Hakai_Project.PartType}, Vector{Hakai_Project.NsetType}}" href="#Hakai_Project.parseIC-Tuple{Vector{String}, Vector{Hakai_Project.InstanceType}, Vector{Hakai_Project.PartType}, Vector{Hakai_Project.NsetType}}"><code>Hakai_Project.parseIC</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parseIC(lines, INSTANCE, PART, NSET) -&gt; Vector{ICType}</code></pre><p>Parses *Initial Conditions blocks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L968-L972">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.parseInstances-Tuple{Vector{String}, Vector{Hakai_Project.PartType}}" href="#Hakai_Project.parseInstances-Tuple{Vector{String}, Vector{Hakai_Project.PartType}}"><code>Hakai_Project.parseInstances</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parseInstances(lines, PART) -&gt; Vector{InstanceType}</code></pre><p>Finds all *Instance blocks and populates an array of InstanceType.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L320-L324">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.parseMassScaling-Tuple{Vector{String}}" href="#Hakai_Project.parseMassScaling-Tuple{Vector{String}}"><code>Hakai_Project.parseMassScaling</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parseMassScaling(lines) -&gt; Float64</code></pre><p>Parses *Fixed Mass Scaling to obtain mass scaling factor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L831-L835">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.parseMaterials-Tuple{Vector{String}}" href="#Hakai_Project.parseMaterials-Tuple{Vector{String}}"><code>Hakai_Project.parseMaterials</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parseMaterials(lines) -&gt; Vector{MaterialType}</code></pre><p>Parses *Material blocks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L679-L683">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.parseParts-Tuple{Vector{String}}" href="#Hakai_Project.parseParts-Tuple{Vector{String}}"><code>Hakai_Project.parseParts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parseParts(lines::Vector{String}) -&gt; Vector{PartType}</code></pre><p>Parses all *Part sections (with nodes/elements) into an array of <code>PartType</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L185-L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.parseStep-Tuple{Vector{String}}" href="#Hakai_Project.parseStep-Tuple{Vector{String}}"><code>Hakai_Project.parseStep</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parseStep(lines) -&gt; (d_time, end_time)</code></pre><p>Parses *Dynamic, Explicit parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L812-L816">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.parseSurfaces-Tuple{Vector{String}, Vector{Hakai_Project.ELsetType}}" href="#Hakai_Project.parseSurfaces-Tuple{Vector{String}, Vector{Hakai_Project.ELsetType}}"><code>Hakai_Project.parseSurfaces</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parseSurfaces(lines, ELSET) -&gt; Vector{SurfaceType}</code></pre><p>Parses *Surface blocks and populates SurfaceType.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L516-L520">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.prepareMaterialProperties!-Tuple{Any}" href="#Hakai_Project.prepareMaterialProperties!-Tuple{Any}"><code>Hakai_Project.prepareMaterialProperties!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepareMaterialProperties!(MODEL)</code></pre><p>Loops over MODEL.MATERIAL to compute and store properties like G, Dmat, and detect if there&#39;s any fracture. Returns a flag indicating whether fracture is enabled in the model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L54-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.readFile-Tuple{String}" href="#Hakai_Project.readFile-Tuple{String}"><code>Hakai_Project.readFile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">readFile(fname::String) -&gt; Vector{String}</code></pre><p>Reads the entire input file into a vector of lines.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L158-L162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.readInpFile-Tuple{String}" href="#Hakai_Project.readInpFile-Tuple{String}"><code>Hakai_Project.readInpFile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">readInpFile(fname::String) -&gt; ModelType</code></pre><p>Top-level function that reads all lines of the .inp file, then parses out all relevant sections into a <code>ModelType</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/ReadInp/readinp.jl#L1127-L1132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.runMainTimeLoop!-NTuple{11, Any}" href="#Hakai_Project.runMainTimeLoop!-NTuple{11, Any}"><code>Hakai_Project.runMainTimeLoop!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">runMainTimeLoop!(MODEL, diag_M, diag_C, disp, disp_new, disp_pre, velo, position,
                 contactData, elementVolume, Pusai_mat)</code></pre><p>Implements the central time-stepping loop:</p><ul><li>updates external forces</li><li>computes contact forces</li><li>enforces boundary conditions</li><li>updates stress/strain</li><li>fracture removal</li><li>writes output periodically</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L337-L348">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.setupContact!-Tuple{Any}" href="#Hakai_Project.setupContact!-Tuple{Any}"><code>Hakai_Project.setupContact!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setupContact!(MODEL)</code></pre><p>Handles logic to build up contact pairs, surfaces, etc. Returns a struct or NamedTuple with contact data (CT, instance<em>pair, cp</em>index, etc.).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L200-L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Hakai_Project.write_vtk-Tuple{Int64, AbstractMatrix{Float64}, AbstractMatrix{Int64}, AbstractVector{Int64}, AbstractVector{Float64}, AbstractVector{Float64}, Hakai_Project.NodeDataType}" href="#Hakai_Project.write_vtk-Tuple{Int64, AbstractMatrix{Float64}, AbstractMatrix{Int64}, AbstractVector{Int64}, AbstractVector{Float64}, AbstractVector{Float64}, Hakai_Project.NodeDataType}"><code>Hakai_Project.write_vtk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_vtk(index::Int, coordmat::AbstractMatrix{T}, elementmat::AbstractMatrix{Int},
          element_flag::AbstractVector{Int}, disp::AbstractVector{T}, velo::AbstractVector{T},
          node_data::NodeDataType)</code></pre><p>Writes a .vtk file (in unstructured-grid format) for the mesh and nodal data at the given <code>index</code>. Stores the file in <code>temp/file###.vtk</code>.</p><p>Arguments:   • <code>coordmat</code>     : a 3×nNode matrix of the original node coordinates (column-major).   • <code>elementmat</code>   : an 8×nElement matrix of node indices for each hexahedral element.   • <code>element_flag</code> : an nElement vector of 1/0 flags indicating whether each element is active or deleted.   • <code>disp</code>         : a 3<em>nNode vector of nodal displacements, stored in [x1,y1,z1, x2,y2,z2, …].   • <code>velo</code>         : a 3</em>nNode vector of nodal velocities, same layout as <code>disp</code>.   • <code>node_data</code>    : a <code>NodeDataType</code> struct, containing node-level stresses, strains, etc.</p><p>Output:   • Creates a file named &quot;temp/file###.vtk&quot; where ### is the zero-padded index.</p><p>Notes:   • The VTK file is ASCII, &quot;DATASET UNSTRUCTURED<em>GRID&quot;.   • Only hex8 cell types are handled (CELL</em>TYPES 12).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yolhan83/Hakai_Project.jl/blob/13d0dea8e345f7a3ce85ab59441aa8c9c9b242fc/src/Hakai/hakai.jl#L1203-L1225">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Wednesday 12 March 2025 19:48">Wednesday 12 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
